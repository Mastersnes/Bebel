define(["jquery","app/utils/utils","app/data/kongregateStats","kongregate"],function(g,c,e){return function(f){this.init=function(a){this.Textes=a;this.isLoad=!1;this.username=null;this.isGuest=!0};this.load=function(a){var b=this;kongregateAPI.loadAPI(function(){b.isLoad=!0;b.kongregate=kongregateAPI.getAPI();b.makeEvents();a.call()})};this.render=function(){};this.score=function(a,b){this.isLoad&&(b=this.redresseInt(b),this.kongregate.stats.submit(a,b))};this.redresseInt=function(a){return a?a>
Math.pow(10,15)?Math.pow(10,15):a:0};this.getScore=function(a){var b=this;a=e.get(a);if(!(this.isLoad&&this.username&&a))return null;c.load("https://api.kongregate.com/api/high_scores/lifetime/"+a+".json",null,function(a){if(!a)return null;for(var c in a.lifetime_scores){var d=a.lifetime_scores[c];if(d.username==b.username)return d.score}return null})};this.makeEvents=function(){var a=this;this.kongregate.services.addEventListener("login",function(){a.resolve();a.render()});this.resolve();this.render()};
this.resolve=function(){this.username=this.kongregate.services.getUsername();this.isGuest=this.kongregate.services.isGuest();if(null==this.isGuest||void 0==this.isGuest)this.isGuest=!0;console.log("Kongregate username changed to: "+this.username)};this.login=function(){this.isLoad&&this.isGuest&&this.kongregate.services.showRegistrationBox()};this.init(f)}});