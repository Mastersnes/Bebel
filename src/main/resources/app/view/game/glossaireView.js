define("jquery underscore app/utils/utils app/utils/viewUtils text!app/template/game/glossaire.html app/data/items app/data/glossaire app/data/suffixe app/data/etats".split(" "),function(g,p,q,r,s,k,m,n,h){return function(t){this.init=function(a){this.el=g(".glossaire");this.parent=a;this.Textes=a.Textes;this.mediatheque=a.mediatheque;this.kongregateUtils=a.kongregateUtils;this.saveManager=a.saveManager;this.recompenseManager=a.recompenseManager;this.player=a.playerManager;this.render();this.el.hide()};
this.render=function(){p.templateSettings.variable="data";var a=p.template(s),b={text:this.Textes,suffixes:n.list()};this.el.html(a(b));r.verticalCenter();this.initAlphabetDispo();this.makeEvents()};this.initAlphabetDispo=function(){this.el.find(".alphabet marqueurs").empty();this.letters=[["a","b","c","d"],["e","f","g","h"],["i","j","k","l"],["m","n","o","p"],["q","r","s","t"],"uvwxyz".split("")];"eo"==this.Textes.local&&(this.letters=[["a","b","c","ĉ","d"],"efgĝhĥ".split(""),["i","j","ĵ","k","l"],
["m","n","o","p"],["r","s","ŝ","t"],["u","ŭ","v","z"]]);for(var a in this.letters){var b=m.list(this.letters[a],this.Textes,!0);0>=b.length&&(b=k.list(this.letters[a],this.Textes,!0));0>=b.length&&(b=h.list(this.letters[a],this.Textes,!0));if(0<b.length){var c=this.letters[a],b=g("\x3cmarqueur\x3e\x3c/marqueur\x3e");b.attr("id",a);b.attr("name",this.letters[a]);c=c[0].toUpperCase()+"-"+c[c.length-1].toUpperCase();b.html("\x3ctexte\x3e"+c+"\x3c/texte\x3e");this.el.find(".alphabet marqueurs").append(b)}}this.currentLetter=
this.letters[0]};this.initSuffixesDispo=function(a,b){var c=n.list(),e=this.el.find("suffixes");e.empty();var d=[];a.suffixes&&(d=a.suffixes);for(var f in c){var h=c[f];if(!h.unique||f==b||-1!=d.indexOf(f)){var l=g("\x3csuffixe\x3e\x3c/suffixe\x3e");l.attr("id",f);"m"==a.sexe?l.html(this.Textes.get(h.namem)):l.html(this.Textes.get(h.namef));e.append(l)}}};this.show=function(a,b){this.current=a;this.el.find(".liste").hide();this.el.find(".description suffixes").hide();this.showEtat(a)||this.showMonster(a,
b)||this.showItem(a);var c=this.letters[0],e=q.normalize(this.Textes.get(a)),d;for(d in this.letters)if(-1!=this.letters[d].indexOf(e[0])){c=this.letters[d];break}this.el.find("marqueur").removeClass("selected");this.el.find("marqueur[name\x3d'"+c+"']").addClass("selected");this.el.find(".description").show();this.el.fadeIn()};this.showEtat=function(a){a=h.get(a);if(!a||!a.name)return!1;var b=this.el.find(".description"),c=this.Textes.get(a.name);b.find("titre").html(c);b.find("suffixe#selected, fleche").hide();
b.find("texte").html(this.Textes.get(a.name+"-texte"));b.find("infos").empty();this.addInfoTxt(a.commentaire);this.addInfo("duree",a.duree,null,"tours");this.addInfo("degats",a.degats,null);this.addInfo("lifeGain",a.vie,null,"lifeGain-glossaire");a.multicible&&this.addInfo("multicible",this.Textes.get("oui"));this.makeZoomEvents();return!0};this.showItem=function(a){a=k.get(a);if(!a||!a.name)return!1;var b=this.el.find(".description"),c=this.Textes.get(a.name);b.find("titre").html(c);b.find("suffixe#selected, fleche").hide();
b.find("texte").html(this.Textes.get(a.texte));b.find("infos").empty();this.addInfoTxt(a.commentaire);this.addInfo("degats",a.degats,null);this.addInfo("defense",a.defense,null);a.degats?this.addInfo("lifeSteal",a.lifeSteal,null,"lifeSteal-glossaire"):this.addInfo("lifeSteal",a.lifeSteal,null,"lifeSteal2-glossaire");this.addInfo("manaSteal",a.manaSteal,null,"manaSteal-glossaire");this.addInfo("manaCost",a.manaCost,null);this.addInfo("lifeGain",a.vie,null,"lifeGain-glossaire");this.addInfo("manaGain",
a.mana,null,"manaGain-glossaire");a.multicible&&this.addInfo("multicible",this.Textes.get("oui"));if(a.effet){var b=[],c=[],e;for(e in a.effet){var d=a.effet[e];h.get(d).offensif?b.push(d):c.push(d)}this.addInfoList("inflige",b);this.addInfoList("octroie",c)}this.makeZoomEvents();return!0};this.showMonster=function(a,b,c){a=m.get(a);if(!a||!a.name)return!1;var e=this.el.find(".description");c||this.initSuffixesDispo(a,b);var d=this.Textes.get(a.name);c||e.find("titre").html(d+" ");e.find("suffixe#selected, fleche").show();
d=e.find("suffixes suffixe:first").attr("id");a.baseSuffixe&&(d=a.baseSuffixe);b&&(d=b);c||e.find("texte").html(this.Textes.get(a.texte));d=n.get(d);"m"==a.sexe?e.find("suffixe#selected").html(this.Textes.get(d.namem)):e.find("suffixe#selected").html(this.Textes.get(d.namef));e.find("infos").empty();this.addInfoTxt(a.commentaire);this.addInfo("vie",a.vie,d.vie);this.addInfo("mana",a.mana,d.mana);this.addInfo("attack",a.attaque,d.attaque);this.addInfo("experienceGain",a.xp,d.xp);this.addInfo("argentGain",
a.argent,d.argent);this.addInfoList("competences",a.abilities);this.addInfoList("items",a.consos);this.makeZoomEvents();return!0};this.addInfoTxt=function(a,b){if(void 0!=a){var c=g("\x3cinfo\x3e\x3c/info\x3e");c.html(this.Textes.get(a));b&&c.append(this.Textes.get(b));c.addClass("large");c.addClass("texte");this.el.find("infos").append(c)}};this.addInfo=function(a,b,c,e){if(void 0!=b){void 0==c&&(c=1);var d=g("\x3cinfo\x3e\x3c/info\x3e"),f="";a&&(f="\x3cb\x3e"+this.Textes.get(a)+" :\x3c/b\x3e ");
Array.isArray(b)?(a=Math.round(b[0]*c),b=Math.round(b[1]*c),a==b?d.html(f+a):d.html(f+a+"-"+b)):0<=b||0>b?d.html(f+Math.round(b*c)):d.html(f+b);e&&d.append(this.Textes.get(e));16<d.html().length-7&&d.addClass("large");this.el.find("infos").append(d)}};this.addInfoList=function(a,b){if(void 0!=b&&0!=b.length){for(var c=g("\x3cinfoList\x3e\x3c/infoList\x3e"),e="\x3cb\x3e"+this.Textes.get(a)+" :\x3c/b\x3e ",d=0;d<b.length;d++){var f=k.get(b[d]);f.name||(f=h.get(b[d]));e+="\x3cspan ref\x3d'"+b[d]+"'\x3e"+
this.Textes.get(f.name)+"\x3c/span\x3e";d<b.length-1&&(e+=", ")}c.html(e);this.el.find("infos").append(c)}};this.list=function(){var a=this,b=this.currentLetter;this.el.find(".description").hide();this.el.find("marqueur").removeClass("selected");this.el.find("marqueur[name\x3d'"+b+"']").addClass("selected");this.el.find(".liste propositions").empty();var c=m.list(b,this.Textes),c=c.concat(k.list(b,this.Textes)),c=c.concat(h.list(b,this.Textes));c.sort(function(b,c){var d=a.Textes.get(b),e=a.Textes.get(c);
return d.localeCompare(e)});var b=this.el.find(".gauche propositions"),e;for(e in c){var d=c[e],f=g("\x3cproposition\x3e\x3c/proposition\x3e");f.html(this.Textes.get(d));f.attr("id",d);b.append(f);9<=e&&(b=this.el.find(".droite propositions"))}this.makePropositionEvents();this.el.find(".liste").show();this.el.fadeIn()};this.makeEvents=function(){var a=this;this.el.find(".canClose").click(function(b){g(b.target).hasClass("canClose")&&a.el.fadeOut()});this.el.find(".alphabet marqueur").click(function(){var b=
parseInt(g(this).attr("id"));a.currentLetter=a.letters[b];a.list()});this.el.find(".description suffixe#selected, .description fleche").click(function(b){b=a.el.find(".description");if(b.find("suffixes").is(":visible"))b.find("suffixes").hide();else{var c=b.find("suffixe#selected").position().left;b.find("suffixes").css({left:q.toPercent(c,b.find("entete").width())+"%"});b.find("suffixes").show()}})};this.makePropositionEvents=function(){var a=this;this.el.find(".liste propositions proposition").click(function(){var b=
g(this).attr("id");a.show(b)});this.el.find(".description").click(function(b){g(b.target).is("suffixes, suffixe, fleche")||(b=a.el.find(".description suffixes"),b.is(":visible")&&b.hide())})};this.makeZoomEvents=function(){var a=this;this.el.find(".description suffixes suffixe").off("click");this.el.find(".description suffixes suffixe").click(function(b){a.el.find(".description suffixes").hide();b=g(this).attr("id");a.showMonster(a.current,b,!0)});this.el.find(".description span").off("click");this.el.find(".description span").click(function(){var b=
g(this).attr("ref");a.show(b)})};this.init(t)}});